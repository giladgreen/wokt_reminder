{"version":3,"sources":["actions/getSearchResults.js","actions/getSubscriptions.js","App.js","actions/subscribeRestaurant.js","actions/unsubscribeRestaurant.js","index.jsx","actions/url.js"],"names":["restaurantName","location","a","Promise","resolve","reject","options","method","url","URL_PREFIX","headers","body","JSON","stringify","request","error","response","statusCode","console","bodyObj","parse","title","results","getSearchResults","provider","token","parsedBody","getSubscriptions","isMobile","test","navigator","userAgent","lat","localStorage","getItem","lon","getLocation","geolocation","log","getCurrentPosition","position","coords","latitude","longitude","setItem","err","App","onSearchRestaurantValueChange","event","setState","searchRestaurantValue","target","value","checkForChanges","bind","state","subscriptions","forEach","subscription","result","find","i","track_id","restaurantId","isOpen","Audio","play","tabKey","alert","this","subscribe","name","thinking","setImmediate","subscribeRestaurant","unsubscribe","confirm","unsubscribeRestaurant","search","searchWasClicked","getRestaurantDiv","shortDescription","image","overlay","address","searchPage","subscriber","email","offline","className","onClick","src","length","firstName","familyName","imageUrl","onKeyChange","onLoginFailure","performLogin","userContext","issueDate","Date","removeItem","googleResponse","accessToken","facebookResponse","setTimeout","authData","Boolean","id","clientId","onSuccess","onFailure","render","renderProps","disableMobileRedirect","appId","autoLoad","fields","callback","subscriptionsDivs","sort","subscriptionA","subscriptionB","isAdmin","map","restaurantImage","restaurantAddress","defaultActiveKey","style","fontSize","activeKey","onSelect","variant","eventKey","type","onChange","disabled","venue","short_description","Component","object","positions","BOTTOM_CENTER","timeout","offset","transition","transitions","SCALE","Root","template","AlertTemplate","ReactDOM","document","getElementById","window","origin","includes"],"mappings":"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","file":"static/js/main.a734570e.chunk.js","sourcesContent":["\nimport request from 'request';\n\nimport URL_PREFIX from './url';\nasync function getSearchResults(restaurantName, location) {\n  return new Promise((resolve, reject) => {\n    const options = {\n      method: 'POST',\n      url: `${URL_PREFIX}/search`,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        restaurantName,\n        location,\n      }),\n    };\n\n    request(options, (error, response, body) => {\n      if (error || response.statusCode >= 400) {\n        if (error) {\n          console.error('request cb error.failed to getSearchResults', error);\n          return reject('failed to get getSearchResults');\n        }\n        const bodyObj = JSON.parse(body);\n        console.error('failed to getSearchResults', bodyObj);\n        return reject(bodyObj.title);\n      }\n      const { results } = JSON.parse(body);\n      return resolve(results);\n    });\n  });\n}\n\nexport default getSearchResults;\n","\nimport request from 'request';\nimport URL_PREFIX from './url';\n\nasync function getSubscriptions(provider, token) {\n  return new Promise((resolve, reject) => {\n    const options = {\n      method: 'GET',\n      url: `${URL_PREFIX}/subscriptions`,\n      headers: {\n        provider,\n        'x-auth-token': token,\n        'Content-Type': 'application/json',\n      }\n    };\n\n    request(options, (error, response, body) => {\n      if (error || response.statusCode >= 400) {\n        if (error) {\n          console.error('request cb error.failed to get getSubscriptions', error);\n          return reject('failed to get getSubscriptions');\n        }\n        const bodyObj = typeof body === 'object' ? body : JSON.parse(body);\n        console.error('failed to getSubscriptions data', bodyObj);\n        return reject(bodyObj.title);\n      }\n      const parsedBody = JSON.parse(body);\n      return resolve(parsedBody);\n    });\n  });\n}\n\nexport default getSubscriptions;\n","/* eslint-disable no-lone-blocks */\n/* eslint-disable no-restricted-globals */\nimport React, { Component } from 'react';\nimport getSearchResults from './actions/getSearchResults';\nimport subscribeRestaurant from './actions/subscribeRestaurant';\nimport unsubscribeRestaurant from './actions/unsubscribeRestaurant';\nimport getSubscriptions from './actions/getSubscriptions';\nimport FacebookLogin from  'react-facebook-login/dist/facebook-login-render-props';\nconst GOOGLE_CLIENT_ID= '79744445247-r6hecpeic6csggbl5c40isiqfshf15l7.apps.googleusercontent.com';\nconst FACEBOOK_APP_ID= '4683699325055690';\nconst MY_MAIL = 'green.gilad@gmail.com';\nimport { GoogleLogin } from 'react-google-login';\nimport Tabs from 'react-bootstrap/Tabs'\nimport Tab from 'react-bootstrap/Tab'\n\nconst isMobile = ( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));\nconst location = {\n    lat: localStorage.getItem('lat') || '32.083758287943695',\n    lon: localStorage.getItem('lon') || '34.79441564530134',\n}\nfunction beep() {\n    var snd = new Audio(\"data:audio/wav;base64,//uQRAAAAWMSLwUIYAAsYkXgoQwAEaYLWfkWgAI0wWs/ItAAAGDgYtAgAyN+QWaAAihwMWm4G8QQRDiMcCBcH3Cc+CDv/7xA4Tvh9Rz/y8QADBwMWgQAZG/ILNAARQ4GLTcDeIIIhxGOBAuD7hOfBB3/94gcJ3w+o5/5eIAIAAAVwWgQAVQ2ORaIQwEMAJiDg95G4nQL7mQVWI6GwRcfsZAcsKkJvxgxEjzFUgfHoSQ9Qq7KNwqHwuB13MA4a1q/DmBrHgPcmjiGoh//EwC5nGPEmS4RcfkVKOhJf+WOgoxJclFz3kgn//dBA+ya1GhurNn8zb//9NNutNuhz31f////9vt///z+IdAEAAAK4LQIAKobHItEIYCGAExBwe8jcToF9zIKrEdDYIuP2MgOWFSE34wYiR5iqQPj0JIeoVdlG4VD4XA67mAcNa1fhzA1jwHuTRxDUQ//iYBczjHiTJcIuPyKlHQkv/LHQUYkuSi57yQT//uggfZNajQ3Vmz+Zt//+mm3Wm3Q576v////+32///5/EOgAAADVghQAAAAA//uQZAUAB1WI0PZugAAAAAoQwAAAEk3nRd2qAAAAACiDgAAAAAAABCqEEQRLCgwpBGMlJkIz8jKhGvj4k6jzRnqasNKIeoh5gI7BJaC1A1AoNBjJgbyApVS4IDlZgDU5WUAxEKDNmmALHzZp0Fkz1FMTmGFl1FMEyodIavcCAUHDWrKAIA4aa2oCgILEBupZgHvAhEBcZ6joQBxS76AgccrFlczBvKLC0QI2cBoCFvfTDAo7eoOQInqDPBtvrDEZBNYN5xwNwxQRfw8ZQ5wQVLvO8OYU+mHvFLlDh05Mdg7BT6YrRPpCBznMB2r//xKJjyyOh+cImr2/4doscwD6neZjuZR4AgAABYAAAABy1xcdQtxYBYYZdifkUDgzzXaXn98Z0oi9ILU5mBjFANmRwlVJ3/6jYDAmxaiDG3/6xjQQCCKkRb/6kg/wW+kSJ5//rLobkLSiKmqP/0ikJuDaSaSf/6JiLYLEYnW/+kXg1WRVJL/9EmQ1YZIsv/6Qzwy5qk7/+tEU0nkls3/zIUMPKNX/6yZLf+kFgAfgGyLFAUwY//uQZAUABcd5UiNPVXAAAApAAAAAE0VZQKw9ISAAACgAAAAAVQIygIElVrFkBS+Jhi+EAuu+lKAkYUEIsmEAEoMeDmCETMvfSHTGkF5RWH7kz/ESHWPAq/kcCRhqBtMdokPdM7vil7RG98A2sc7zO6ZvTdM7pmOUAZTnJW+NXxqmd41dqJ6mLTXxrPpnV8avaIf5SvL7pndPvPpndJR9Kuu8fePvuiuhorgWjp7Mf/PRjxcFCPDkW31srioCExivv9lcwKEaHsf/7ow2Fl1T/9RkXgEhYElAoCLFtMArxwivDJJ+bR1HTKJdlEoTELCIqgEwVGSQ+hIm0NbK8WXcTEI0UPoa2NbG4y2K00JEWbZavJXkYaqo9CRHS55FcZTjKEk3NKoCYUnSQ0rWxrZbFKbKIhOKPZe1cJKzZSaQrIyULHDZmV5K4xySsDRKWOruanGtjLJXFEmwaIbDLX0hIPBUQPVFVkQkDoUNfSoDgQGKPekoxeGzA4DUvnn4bxzcZrtJyipKfPNy5w+9lnXwgqsiyHNeSVpemw4bWb9psYeq//uQZBoABQt4yMVxYAIAAAkQoAAAHvYpL5m6AAgAACXDAAAAD59jblTirQe9upFsmZbpMudy7Lz1X1DYsxOOSWpfPqNX2WqktK0DMvuGwlbNj44TleLPQ+Gsfb+GOWOKJoIrWb3cIMeeON6lz2umTqMXV8Mj30yWPpjoSa9ujK8SyeJP5y5mOW1D6hvLepeveEAEDo0mgCRClOEgANv3B9a6fikgUSu/DmAMATrGx7nng5p5iimPNZsfQLYB2sDLIkzRKZOHGAaUyDcpFBSLG9MCQALgAIgQs2YunOszLSAyQYPVC2YdGGeHD2dTdJk1pAHGAWDjnkcLKFymS3RQZTInzySoBwMG0QueC3gMsCEYxUqlrcxK6k1LQQcsmyYeQPdC2YfuGPASCBkcVMQQqpVJshui1tkXQJQV0OXGAZMXSOEEBRirXbVRQW7ugq7IM7rPWSZyDlM3IuNEkxzCOJ0ny2ThNkyRai1b6ev//3dzNGzNb//4uAvHT5sURcZCFcuKLhOFs8mLAAEAt4UWAAIABAAAAAB4qbHo0tIjVkUU//uQZAwABfSFz3ZqQAAAAAngwAAAE1HjMp2qAAAAACZDgAAAD5UkTE1UgZEUExqYynN1qZvqIOREEFmBcJQkwdxiFtw0qEOkGYfRDifBui9MQg4QAHAqWtAWHoCxu1Yf4VfWLPIM2mHDFsbQEVGwyqQoQcwnfHeIkNt9YnkiaS1oizycqJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=\");\n    snd.play();\n}\n\nfunction getLocation(){\n    if (navigator.geolocation)\n    {\n        console.log('calling getCurrentPosition')\n        navigator.geolocation.getCurrentPosition((position)=>{\n            location.lat=position.coords.latitude;\n            location.lon=position.coords.longitude;\n             localStorage.setItem('lat', location.lat);\n             localStorage.setItem('lon', location.lon);\n        },(err)=>{\n            console.log('calling getCurrentPosition got error:', err)\n        });\n    }\n    else{\n        console.log('no navigator.geolocation')\n    }\n}\n\nclass App extends Component {\n\n    constructor() {\n        super();\n        setTimeout(getLocation, 500);\n        const searchRestaurantValue = localStorage.getItem('searchRestaurantValue') || '';\n        setTimeout(async ()=>{\n            const authData = localStorage.getItem('authData');\n            if (authData){\n                const {provider, token } = JSON.parse(authData);\n                if (provider && token) {\n                    const { subscriptions, userContext } = await getSubscriptions(provider, token)\n                    this.setState({ subscriptions, email: userContext.email });\n                }\n            }\n        },400)\n        this.state = {\n            email: null,\n            searchRestaurantValue,\n            results:[],\n            subscriptions:[],\n            tabKey:'search',\n            searchWasClicked: false,\n            thinking: false\n        };\n        //setInterval(this.checkForChanges,30000)\n    }\n    onSearchRestaurantValueChange = (event) => {\n        this.setState({ searchRestaurantValue: event.target.value });\n    }\n\n    checkForChanges = async() => {\n        const setState = this.setState.bind(this);\n        if (!this.state.subscriptions) return;\n        this.state.subscriptions.forEach(async (subscription)=>{\n            const results = await getSearchResults(subscription.restaurantName, { lat: subscription.lat, lon: subscription.lon });\n            const result = results.find(i => i.track_id === subscription.restaurantId);\n            if (result && result.isOpen) {\n                beep();\n                setState({ tabKey: 'search' });\n                alert(`${subscription.restaurantName} is now open`);\n            } else{\n                console.log('still close', subscription.restaurantName)\n            }\n        })\n    }\n    subscribe = async(name, restaurantId) => {\n        const setState = this.setState.bind(this);\n        setState({ thinking:true });\n        const {provider, token } = JSON.parse(localStorage.getItem('authData'));\n\n        setImmediate(async ()=>{\n            console.log('about to subscribe for restaurant:', name, restaurantId)\n            const subscriptions = await subscribeRestaurant(name, restaurantId, location, provider, token);\n            console.log('subscriptions:', subscriptions);\n            setState({ thinking:false, subscriptions, tabKey: 'subscriptions' });\n        })\n    }\n    unsubscribe = async(name, restaurantId) => {\n        const setState = this.setState.bind(this);\n        setState({ thinking:true });\n        const {provider, token } = JSON.parse(localStorage.getItem('authData'));\n\n        setImmediate(async ()=>{\n            if (confirm(\"Unsubscribe?\")){\n                console.log('about to unsubscribe for restaurant:', name, restaurantId);\n                const subscriptions = await unsubscribeRestaurant(name, restaurantId, location, provider, token);\n                console.log('subscriptions:', subscriptions);\n                setState({ thinking:false, subscriptions, tabKey: 'subscriptions' });\n            }else{\n                setState({ thinking:false });\n            }\n\n\n        })\n    }\n\n    search = async() => {\n        const setState = this.setState.bind(this);\n        setState({ thinking:true });\n        setImmediate(async ()=>{\n            console.log('about to search for restaurant:', this.state.searchRestaurantValue)\n            localStorage.setItem('searchRestaurantValue', this.state.searchRestaurantValue);\n            const results = await getSearchResults(this.state.searchRestaurantValue, location);\n            setState({ results, searchWasClicked:true, thinking:false });\n        })\n    }\n\n    getRestaurantDiv = (title,shortDescription, image, overlay,restaurantId, address, isOpen, searchPage, subscriber, email)=>{\n        if (!searchPage){\n            console.log('getRestaurantDiv', title, image, overlay,restaurantId, address, isOpen, searchPage)\n            console.log('subscriber', subscriber)\n        }\n\n        const offline = !isOpen;\n\n        return <div key={title} className={`col-xs-6 restaurant-result-div ${offline ?'offline':''} ${ isMobile ? 'mobile-width' : ''}`} onClick={()=> offline && searchPage ? this.subscribe(title, restaurantId) : !searchPage && this.state.email === email ? this.unsubscribe(title, restaurantId) : ()=>{}}>\n            <div> <img src={image}/></div>\n            <div className=\"restaurant-title\">{title}</div>\n            <div className=\"restaurant-short-description\">{shortDescription}</div>\n\n            <div className=\"restaurant-address\">{address}</div>\n            {overlay && overlay.length ? <div className=\"overlay\">{overlay}</div> : <span></span>}\n            {offline && searchPage ? <div className=\"action-prompt\">Click to Subscribe</div>: <span></span> }\n            {!searchPage && this.state.email === email ? <div className=\"action-prompt\">Click to Unsubscribe</div>: <span></span> }\n            {!searchPage && this.state.email === MY_MAIL ? <div className=\"email-data\">({email})</div>: <span></span> }\n            {subscriber ? <div>\n                <div> { subscriber.firstName} { subscriber.familyName}</div>\n                <div> <img src={ subscriber.imageUrl}/></div>\n            </div>:<div></div>}\n        </div>\n    }\n    onKeyChange = (tabKey)=>{\n        this.setState({tabKey });\n    };\n    onLoginFailure = (error) => {\n        console.error('App onFailure', error);\n    };\n    performLogin = async (provider, token) => {\n        const setState = this.setState.bind(this);\n        setState({ thinking:true });\n        setImmediate(async ()=>{\n            try{\n                const {subscriptions, userContext} = await getSubscriptions(provider, token);\n                this.setState({ subscriptions, email: userContext.email, thinking:false });\n                const issueDate  = new Date();\n                localStorage.setItem('authData', JSON.stringify({provider, token, issueDate }));\n                localStorage.setItem('email', userContext.email);\n            } catch(error) {\n                localStorage.removeItem('authData');\n                console.log('error', error)\n                alert('failed to login');\n                setState({ thinking:false });\n            }\n\n        })\n\n\n    };\n\n    googleResponse = (response) => {\n        if (response.accessToken){\n            this.performLogin('google', response.accessToken);\n        }else{\n            this.onLoginFailure('login failed')\n        }\n\n    };\n    facebookResponse = (response) => {\n        if (response.accessToken){\n            this.performLogin('facebook', response.accessToken);\n        }else{\n            this.onLoginFailure('login failed')\n        }\n\n    };\n    render() {\n        console.log('render, state:', this.state)\n        const loggedIn = Boolean(this.state.email);\n        if (!loggedIn){\n\n\n            return <div id=\"login-page\">\n                <div id=\"login-page-header\">\n                    login page\n                </div>\n                <div id=\"login-body\">\n                    <div>\n                        <GoogleLogin\n                        clientId={GOOGLE_CLIENT_ID}\n                        onSuccess={this.googleResponse}\n                        onFailure={this.onLoginFailure}\n                        render={renderProps => (\n                            <div className=\"login-button login-button-google\" onClick={renderProps.onClick}> LOGIN WITH GOOGLE</div>\n                        )}\n                    />\n                    </div>\n                    <div>\n                        <FacebookLogin\n                        disableMobileRedirect={true}\n                        appId={FACEBOOK_APP_ID}\n                        autoLoad={false}\n                        fields=\"name,email\"\n                        callback={this.facebookResponse}\n                        render={renderProps => (\n                            <div id=\"fbButton\" className=\"login-button login-button-fb\" onClick={renderProps.onClick}> LOGIN WITH FACEBOOK</div>\n                        )}/>\n                    </div>\n                </div>\n            </div>\n        }\n\n        let subscriptionsDivs = <div></div>;\n        if (this.state.subscriptions.length) {\n            console.log('this.state.subscriptions', this.state.subscriptions)\n            const subscriptions = this.state.subscriptions[0].subscriber\n                ? this.state.subscriptions.sort((subscriptionA, subscriptionB)=>{\n                    if (subscriptionA.isAdmin) return -1;\n                    if (subscriptionB.isAdmin) return 1;\n                    return 0;\n                }) : this.state.subscriptions;\n\n            console.log('subscriptions', subscriptions)\n            subscriptionsDivs = subscriptions.map(subscription =>{\n                console.log('subscription', subscription)\n                const { restaurantName: title, restaurantImage: image, restaurantId, restaurantAddress: address, subscriber, email  } = subscription;\n                if (subscriber){\n                    subscriber.isAdmin = subscription.isAdmin;\n                }\n                return this.getRestaurantDiv(title,'', image, null,restaurantId, address, false, false, subscriber, email);\n            })\n        }\n\n        return (\n            <div>\n                <div id=\"login-data\">\n                    {this.state.email}<br/>\n                    <span id=\"log-out-button\" onClick={()=>{\n                        localStorage.removeItem('email');\n                        this.setState({ email: null});\n                    }}>log out</span>\n                </div>\n                <div>\n                    <h1><u>Wolt Helper</u></h1>\n                </div>\n                <Tabs defaultActiveKey=\"search\" id=\"uncontrolled-tab-example\" style={{fontSize: isMobile ? \"0.8em\" : \"1em\"}} activeKey={this.state.tabKey} onSelect={this.onKeyChange} variant=\"pills\">\n                    <Tab eventKey=\"search\" title=\"search\" >\n                        <div>\n                            <div id=\"search-restaurant-div\">\n\n                                <input type=\"text\" id=\"search-restaurant-input\" value={this.state.searchRestaurantValue} onChange={this.onSearchRestaurantValueChange} />\n                                <button id=\"search-restaurant-button\" onClick={this.search} disabled={this.state.searchRestaurantValue.length === 0}>search</button>\n                            </div>\n                            <div id=\"search-results\">\n                                { this.state.searchWasClicked ? <div>\n                                    {this.state.results.length} restaurants found.\n                                </div> : <div></div>}\n                                <div className=\"row\">\n                                    {\n                                        this.state.results.map((result) =>{\n                                            const {title, image: {url: image}, overlay, track_id: restaurantId, venue: { address, short_description}, isOpen }= result;\n                                            return this.getRestaurantDiv(title, short_description, image, overlay,restaurantId, address, isOpen, true);\n                                        })\n                                    }\n                                </div>\n                            </div>\n                        </div>\n                    </Tab>\n                    <Tab eventKey=\"subscriptions\" title=\"subscriptions\" >\n                        <div>\n                            <div>\n                                {this.state.subscriptions.length} subscriptions\n                            </div>\n                            <div className=\"row\">\n                                {subscriptionsDivs}\n                            </div>\n                        </div>\n                    </Tab>\n                </Tabs>\n\n                {this.state.thinking ? <div className=\"sivivator\"> <img id=\"sivivator-gif\" src='loading.gif'/></div>: <div></div>}\n\n            </div>);\n\n    }\n}\n\nexport default App;\n\n","\nimport request from 'request';\nimport URL_PREFIX from './url';\n\nasync function subscribeRestaurant(restaurantName, restaurantId, location, provider, token) {\n  const body = JSON.stringify({\n    restaurantName,\n    restaurantId,\n    location\n  });\n\n  return new Promise((resolve, reject) => {\n    const options = {\n      method: 'POST',\n      url: `${URL_PREFIX}/subscriptions`,\n      headers: {\n        provider,\n        'x-auth-token': token,\n        'Content-Type': 'application/json',\n      },\n      body,\n    };\n\n    request(options, (error, response, body) => {\n      if (error || response.statusCode >= 400) {\n        if (error) {\n          console.error('request cb error.failed to get subscribeRestaurant', error);\n          return reject('failed to get subscribeRestaurant');\n        }\n        const bodyObj = typeof body === object ? body : JSON.parse(body);\n        console.error('failed to subscribeRestaurant data', bodyObj);\n        return reject(bodyObj.title);\n      }\n      const parsedBody = JSON.parse(body);\n      console.log('subscribeRestaurant, parsedBody',parsedBody)\n      localStorage.setItem('email', parsedBody.userContext.email);\n      return resolve(parsedBody.subscriptions);\n    });\n  });\n}\n\nexport default subscribeRestaurant;\n","\nimport request from 'request';\nimport URL_PREFIX from './url';\n\nasync function unsubscribeRestaurant(restaurantName, restaurantId, location, provider, token) {\n  const body = JSON.stringify({\n    restaurantName,\n    restaurantId,\n    location,\n  });\n\n  return new Promise((resolve, reject) => {\n    const options = {\n      method: 'POST',\n      url: `${URL_PREFIX}/unsubscribe`,\n      headers: {\n        provider,\n        'x-auth-token': token,\n        'Content-Type': 'application/json',\n      },\n      body,\n    };\n\n    request(options, (error, response, body) => {\n      if (error || response.statusCode >= 400) {\n        if (error) {\n          console.error('request cb error.failed to get unsubscribeRestaurant', error);\n          return reject('failed to get unsubscribeRestaurant');\n        }\n        const bodyObj = typeof body === object ? body : JSON.parse(body);\n        console.error('failed to unsubscribeRestaurant data', bodyObj);\n        return reject(bodyObj.title);\n      }\n      const parsedBody = JSON.parse(body);\n      console.log('unsubscribeRestaurant, parsedBody',parsedBody)\n      localStorage.setItem('email', parsedBody.userContext.email);\n      return resolve(parsedBody.subscriptions);\n    });\n  });\n}\n\nexport default unsubscribeRestaurant;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport { transitions, positions, Provider as AlertProvider } from 'react-alert';\nimport AlertTemplate from 'react-alert-template-basic';\n\nimport './style/app.css';\n\nconst options = {\n    // you can also just use 'bottom center'\n    position: positions.BOTTOM_CENTER,\n    timeout: 3000,\n    offset: '30px',\n    // you can also just use 'scale'\n    transition: transitions.SCALE\n}\n\nconst Root = () => (\n    <AlertProvider template={AlertTemplate} {...options}>\n        <App />\n    </AlertProvider>\n)\n\n\nReactDOM.render(\n    <Root/>,\n  document.getElementById('root')\n);\n","const URL_PREFIX = window.location.origin.includes('localhost') ? 'https://wolt-wrapper.herokuapp.com' : window.location.origin; //https://wolt-wrapper.herokuapp.com' // 'http://localhost:5002'\n\nexport default URL_PREFIX\n"],"sourceRoot":""}